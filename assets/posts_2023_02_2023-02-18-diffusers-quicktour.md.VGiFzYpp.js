import{_ as p}from"./chunks/ArticleMetadata.BPvFAaDD.js";import{_ as l,m as o,a as d,u as g,B as f,e as i,x as c,aj as h,o as t,p as u,q as k}from"./chunks/framework.Ba_Ek9Jm.js";import"./chunks/theme.BWSJTUuN.js";const w=JSON.parse('{"title":"Diffusersæ•™ç¨‹ï¼šå¿«é€Ÿå¼€å§‹","description":"","frontmatter":{"title":"Diffusersæ•™ç¨‹ï¼šå¿«é€Ÿå¼€å§‹","date":"2023-02-18T00:00:00.000Z","tags":["ai","stable-diffusion"],"category":["AI"]},"headers":[],"relativePath":"posts/2023/02/2023-02-18-diffusers-quicktour.md","filePath":"posts/2023/02/2023-02-18-diffusers-quicktour.md","lastUpdated":1718173059000}'),m={name:"posts/2023/02/2023-02-18-diffusers-quicktour.md"},b=i("h1",{id:"å¿«é€Ÿæµè§ˆ",tabindex:"-1"},[c("å¿«é€Ÿæµè§ˆ "),i("a",{class:"header-anchor",href:"#å¿«é€Ÿæµè§ˆ","aria-label":'Permalink to "å¿«é€Ÿæµè§ˆ"'},"â€‹")],-1),_=h(`<p>å¿«é€Ÿå¯åŠ¨å¹¶è¿è¡ŒğŸ§¨æ‰©æ•£å™¨ï¼ æ— è®ºæ‚¨æ˜¯å¼€å‘äººå‘˜è¿˜æ˜¯æ—¥å¸¸ç”¨æˆ·ï¼Œæ­¤å¿«é€Ÿæ•™ç¨‹éƒ½å°†å¸®åŠ©æ‚¨å…¥é—¨ï¼Œå¹¶å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">DiffusionPipeline</a> è¿›è¡Œæ¨ç†ã€‚</p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…æ‰€æœ‰å¿…è¦çš„åº“ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --upgrade</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> diffusers</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> accelerate</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> transformers</span></span></code></pre></div><ul><li>åŠ é€Ÿ<a href="https://huggingface.co/docs/accelerate/index" target="_blank" rel="noreferrer"><code>åŠ é€Ÿ</code></a>æ¨¡å‹åŠ è½½ä»¥è¿›è¡Œæ¨ç†å’Œè®­ç»ƒ</li><li>éœ€è¦<a href="https://huggingface.co/docs/transformers/index" target="_blank" rel="noreferrer"><code>å˜å‹å™¨</code></a>æ¥è¿è¡Œæœ€æµè¡Œçš„æ‰©æ•£æ¨¡å‹ï¼Œä¾‹å¦‚<a href="https://huggingface.co/docs/diffusers/api/pipelines/stable_diffusion/overview" target="_blank" rel="noreferrer">ç¨³å®šæ‰©æ•£</a></li></ul><h2 id="æ‰©æ•£ç®¡é“" tabindex="-1">æ‰©æ•£ç®¡é“ <a class="header-anchor" href="#æ‰©æ•£ç®¡é“" aria-label="Permalink to &quot;æ‰©æ•£ç®¡é“&quot;">â€‹</a></h2><p><a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">æ‰©æ•£ç®¡é“</a>æ˜¯ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„æ‰©æ•£ç³»ç»Ÿè¿›è¡Œæ¨ç†çš„æœ€ç®€å•æ–¹æ³•ã€‚æ‚¨å¯ä»¥å°†å¼€ç®±å³ç”¨çš„<a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">æ‰©æ•£ç®¡é“</a>ç”¨äºè·¨ä¸åŒæ¨¡å¼çš„è®¸å¤šä»»åŠ¡ã€‚è¯·æŸ¥çœ‹ä¸‹è¡¨ï¼Œäº†è§£ä¸€äº›æ”¯æŒçš„ä»»åŠ¡ï¼š</p><table tabindex="0"><thead><tr><th><strong>ä»»åŠ¡</strong></th><th><strong>æè¿°</strong></th><th><strong>ç®¡é“</strong></th></tr></thead><tbody><tr><td>æ— æ¡ä»¶å›¾åƒç”Ÿæˆ</td><td>ä»é«˜æ–¯å™ªå£°ç”Ÿæˆå›¾åƒ</td><td><a href="https://huggingface.co/docs/diffusers/using-diffusers/unconditional_image_generation" target="_blank" rel="noreferrer">unconditional_image_generation</a></td></tr><tr><td>æ–‡æœ¬å¼•å¯¼å›¾åƒç”Ÿæˆ</td><td>åœ¨ç»™å®šæ–‡æœ¬æç¤ºçš„æƒ…å†µä¸‹ç”Ÿæˆå›¾åƒ</td><td><a href="https://huggingface.co/docs/diffusers/using-diffusers/conditional_image_generation" target="_blank" rel="noreferrer">conditional_image_generation</a></td></tr><tr><td>æ–‡æœ¬å¼•å¯¼çš„å›¾åƒåˆ°å›¾åƒè½¬æ¢</td><td>åœ¨æ–‡æœ¬æç¤ºå¼•å¯¼ä¸‹è°ƒæ•´å›¾åƒ</td><td><a href="https://huggingface.co/docs/diffusers/using-diffusers/img2img" target="_blank" rel="noreferrer">img2img</a></td></tr><tr><td>æ–‡æœ¬å¼•å¯¼å›¾åƒä¿®å¤</td><td>åœ¨ç»™å®šå›¾åƒã€è’™ç‰ˆå’Œæ–‡æœ¬æç¤ºçš„æƒ…å†µä¸‹å¡«å……å›¾åƒçš„è’™ç‰ˆéƒ¨åˆ†</td><td><a href="https://huggingface.co/docs/diffusers/using-diffusers/inpaint" target="_blank" rel="noreferrer">ä¸Šæ¼†</a></td></tr><tr><td>æ–‡æœ¬å¼•å¯¼çš„å›¾åƒæ·±åº¦ç¿»è¯‘</td><td>åœ¨æ–‡æœ¬æç¤ºçš„å¼•å¯¼ä¸‹è°ƒæ•´å›¾åƒçš„æŸäº›éƒ¨åˆ†ï¼ŒåŒæ—¶é€šè¿‡æ·±åº¦ä¼°è®¡ä¿ç•™ç»“æ„</td><td><a href="https://huggingface.co/docs/diffusers/using-diffusers/depth2img" target="_blank" rel="noreferrer">æ·±åº¦2img</a></td></tr></tbody></table><p>æœ‰å…³æ‰©æ•£ç®¡é“å¦‚ä½•é’ˆå¯¹ä¸åŒä»»åŠ¡å·¥ä½œçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://huggingface.co/docs/diffusers/using-diffusers/overview" target="_blank" rel="noreferrer"><strong>ä½¿ç”¨æ‰©æ•£å™¨</strong></a>éƒ¨åˆ†ã€‚</p><p>ä¾‹å¦‚ï¼Œé¦–å…ˆåˆ›å»º <a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">DiffusionPipeline</a> çš„å®ä¾‹ï¼Œå¹¶æŒ‡å®šè¦ä¸‹è½½çš„ç®¡é“æ£€æŸ¥ç‚¹ã€‚ æ‚¨å¯ä»¥å°†æ‰©æ•£<a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">ç®¡é“</a>ç”¨äºä»»ä½•<a href="https://huggingface.co/models?library=diffusers&amp;sort=downloads" target="_blank" rel="noreferrer">æ‰©æ•£å™¨çš„æ£€æŸ¥ç‚¹</a>ã€‚ ä¸è¿‡ï¼Œåœ¨æœ¬æŒ‡å—ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨æ‰©æ•£<a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">ç®¡é“</a>é€šè¿‡<a href="https://huggingface.co/CompVis/stable-diffusion" target="_blank" rel="noreferrer">ç¨³å®šæ‰©æ•£</a>ç”Ÿæˆæ–‡æœ¬åˆ°å›¾åƒã€‚</p><p>å¯¹äº<a href="https://huggingface.co/CompVis/stable-diffusion" target="_blank" rel="noreferrer">ç¨³å®šæ‰©æ•£</a>ï¼Œè¯·åœ¨è¿è¡Œæ¨¡å‹ä¹‹å‰ä»”ç»†é˜…è¯»å…¶<a href="https://huggingface.co/spaces/CompVis/stable-diffusion-license" target="_blank" rel="noreferrer">è®¸å¯è¯</a>ã€‚ è¿™æ˜¯ç”±äºæ”¹è¿›äº†æ¨¡å‹çš„å›¾åƒç”ŸæˆåŠŸèƒ½ä»¥åŠå¯èƒ½ç”¨å®ƒç”Ÿæˆçš„æ½œåœ¨æœ‰å®³å†…å®¹ã€‚ è¯·è½¬åˆ°æ‚¨é€‰æ‹©çš„ç¨³å®šæ‰©æ•£æ¨¡å‹ï¼Œ<em>ä¾‹å¦‚</em><a href="https://huggingface.co/runwayml/stable-diffusion-v1-5" target="_blank" rel="noreferrer"><code>runwayml/stable-diffusion-v1-5</code></a>ï¼Œå¹¶é˜…è¯»è®¸å¯è¯ã€‚</p><p>æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼åŠ è½½æ¨¡å‹ï¼š</p><p>å¤åˆ¶</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;&gt;&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> diffusers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> DiffusionPipeline</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pipeline </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> DiffusionPipeline.from_pretrained(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;runwayml/stable-diffusion-v1-5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span></code></pre></div><p><a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/diffusion_pipeline#diffusers.DiffusionPipeline" target="_blank" rel="noreferrer">æ‰©æ•£ç®¡é“</a>ä¸‹è½½å¹¶ç¼“å­˜æ‰€æœ‰å»ºæ¨¡ã€æ ‡è®°åŒ–å’Œè°ƒåº¦ç»„ä»¶ã€‚ ç”±äºè¯¥æ¨¡å‹ç”±å¤§çº¦ 1 äº¿ä¸ªå‚æ•°ç»„æˆï¼Œå› æ­¤æˆ‘ä»¬å¼ºçƒˆå»ºè®®åœ¨ GPU ä¸Šè¿è¡Œå®ƒã€‚ æ‚¨å¯ä»¥å°†ç”Ÿæˆå™¨å¯¹è±¡ç§»åŠ¨åˆ° GPUï¼Œå°±åƒåœ¨ PyTorch ä¸­ä¸€æ ·ã€‚</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; pipeline.to(&quot;cuda&quot;)</span></span></code></pre></div><p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–‡æœ¬æç¤ºï¼š<code>pipeline</code></p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; image = pipeline(&quot;An image of a squirrel in Picasso style&quot;).images[0]</span></span></code></pre></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å‡ºåŒ…è£…åˆ° <a href="https://pillow.readthedocs.io/en/stable/reference/Image.html?highlight=image#the-image-class" target="_blank" rel="noreferrer">PIL Image å¯¹è±¡</a>ä¸­ã€‚</p><p>æ‚¨å¯ä»¥é€šè¿‡ç®€å•åœ°è°ƒç”¨ä»¥ä¸‹å‘½ä»¤æ¥ä¿å­˜å›¾åƒï¼š</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; image.save(&quot;image_of_squirrel_painting.png&quot;)</span></span></code></pre></div><p><strong>æ³¨æ„</strong>ï¼šæ‚¨è¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸‹è½½æƒé‡åœ¨æœ¬åœ°ä½¿ç”¨ç®¡é“ï¼š</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>git lfs install</span></span>
<span class="line"><span>git clone https://huggingface.co/runwayml/stable-diffusion-v1-5</span></span></code></pre></div><p>ç„¶åå°†ä¿å­˜çš„æƒé‡åŠ è½½åˆ°ç®¡é“ä¸­ã€‚</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; pipeline = DiffusionPipeline.from_pretrained(&quot;./stable-diffusion-v1-5&quot;)</span></span></code></pre></div><p>ç„¶åï¼Œè¿è¡Œç®¡é“ä¸ä¸Šé¢çš„ä»£ç ç›¸åŒï¼Œå› ä¸ºå®ƒæ˜¯ç›¸åŒçš„æ¨¡å‹ä½“ç³»ç»“æ„ã€‚</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; generator.to(&quot;cuda&quot;)</span></span>
<span class="line"><span>&gt;&gt;&gt; image = generator(&quot;An image of a squirrel in Picasso style&quot;).images[0]</span></span>
<span class="line"><span>&gt;&gt;&gt; image.save(&quot;image_of_squirrel_painting.png&quot;)</span></span></code></pre></div><p>æ‰©æ•£ç³»ç»Ÿå¯ä»¥ä¸å¤šä¸ªä¸åŒçš„è°ƒåº¦ç¨‹åºä¸€èµ·ä½¿ç”¨ï¼Œæ¯ä¸ª<a href="https://huggingface.co/docs/diffusers/api/schedulers/overview" target="_blank" rel="noreferrer">è°ƒåº¦ç¨‹åº</a>éƒ½æœ‰ ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¨³å®šæ‰©æ•£ä¸ <a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/schedulers/pndm#diffusers.PNDMScheduler" target="_blank" rel="noreferrer">PNDMScheduler</a> ä¸€èµ·è¿è¡Œï¼Œä½†éå¸¸ç®€å• ä½¿ç”¨ä¸åŒçš„è°ƒåº¦ç¨‹åºã€‚*ä¾‹å¦‚ï¼Œ*å¦‚æœæ‚¨æƒ³ä½¿ç”¨ <a href="https://huggingface.co/docs/diffusers/v0.14.0/en/api/schedulers/euler#diffusers.EulerDiscreteScheduler" target="_blank" rel="noreferrer">EulerDiscreteScheduler</a> è°ƒåº¦å™¨ï¼Œ æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ä½¿ç”¨å®ƒï¼š</p><p>å¤åˆ¶</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>&gt;&gt;&gt; from diffusers import EulerDiscreteScheduler</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; pipeline = StableDiffusionPipeline.from_pretrained(&quot;runwayml/stable-diffusion-v1-5&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&gt;&gt;&gt; # change scheduler to Euler</span></span>
<span class="line"><span>&gt;&gt;&gt; pipeline.scheduler = EulerDiscreteScheduler.from_config(pipeline.scheduler.config)</span></span></code></pre></div><p>æœ‰å…³å¦‚ä½•åœ¨è°ƒåº¦ç¨‹åºä¹‹é—´åˆ‡æ¢çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://huggingface.co/docs/diffusers/using-diffusers/schedulers" target="_blank" rel="noreferrer">ä½¿ç”¨è°ƒåº¦ç¨‹åº</a>æŒ‡å—ã€‚</p><p><a href="https://stability.ai/" target="_blank" rel="noreferrer">ç¨³å®šæ€§ AI çš„</a>ç¨³å®šæ‰©æ•£æ¨¡å‹æ˜¯ä¸€ä¸ªä»¤äººå°è±¡æ·±åˆ»çš„å›¾åƒç”Ÿæˆæ¨¡å‹ å¹¶ä¸”å¯ä»¥åšçš„ä¸ä»…ä»…æ˜¯ä»æ–‡æœ¬ç”Ÿæˆå›¾åƒã€‚æˆ‘ä»¬ä¸“é—¨æœ‰ä¸€ä¸ªå®Œæ•´çš„æ–‡æ¡£é¡µé¢ï¼Œ åªæ˜¯ä¸ºäº†<a href="https://huggingface.co/docs/diffusers/conceptual/stable_diffusion" target="_blank" rel="noreferrer">è¿™é‡Œçš„</a>ç¨³å®šæ‰©æ•£ã€‚</p><p>å¦‚æœæ‚¨æƒ³çŸ¥é“å¦‚ä½•ä¼˜åŒ–ç¨³å®šæ‰©æ•£ä»¥åœ¨ç‰¹å®šç¡¬ä»¶ï¼ˆå¦‚ Macï¼‰æˆ– <a href="https://onnxruntime.ai/" target="_blank" rel="noreferrer">ONNX è¿è¡Œæ—¶</a>ä¸Šè¿è¡Œæ›´å°‘çš„å†…å­˜ã€æ›´é«˜çš„æ¨ç†é€Ÿåº¦ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„ ä¼˜åŒ–é¡µé¢ï¼š</p><ul><li><a href="https://huggingface.co/docs/diffusers/optimization/fp16" target="_blank" rel="noreferrer">GPU ä¸Šä¼˜åŒ–çš„ PyTorch</a></li><li><a href="https://huggingface.co/docs/diffusers/optimization/mps" target="_blank" rel="noreferrer">å¸¦æœ‰ PyTorch çš„ Mac OS</a></li><li><a href="https://huggingface.co/docs/diffusers/optimization/onnx" target="_blank" rel="noreferrer">æ¬§æ©å…‹æ–¯</a></li><li><a href="https://huggingface.co/docs/diffusers/optimization/open_vino" target="_blank" rel="noreferrer">å¼€æ”¾è§†é¢‘</a></li></ul><p>å¦‚æœæ‚¨æƒ³å¾®è°ƒæˆ–è®­ç»ƒæ‰©æ•£æ¨¡å‹ï¼Œè¯·æŸ¥çœ‹<a href="https://huggingface.co/docs/diffusers/training/overview" target="_blank" rel="noreferrer"><strong>è®­ç»ƒéƒ¨åˆ†</strong></a></p><p>æœ€åï¼Œå…¬å¼€åˆ†å‘ç”Ÿæˆçš„é•œåƒğŸ¤—æ—¶è¯·ä½“è°…ã€‚</p>`,41);function v(e,y,D,C,P,q){const n=p,r=o("ClientOnly");return t(),d("div",null,[b,g(r,null,{default:f(()=>{var s,a;return[(((s=e.$frontmatter)==null?void 0:s.aside)??!0)&&(((a=e.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(t(),u(n,{key:0,article:e.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),_])}const S=l(m,[["render",v]]);export{w as __pageData,S as default};
