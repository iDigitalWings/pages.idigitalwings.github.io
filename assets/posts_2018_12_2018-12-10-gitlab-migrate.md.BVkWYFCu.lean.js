import{_ as s,a as i,af as t,o as e}from"./chunks/framework.C87LdZyP.js";const k=JSON.parse('{"title":"Gitlab服务器迁移","description":"","frontmatter":{"title":"Gitlab服务器迁移","date":"2018-12-10T00:00:00.000Z","tags":["gitlab"]},"headers":[],"relativePath":"posts/2018/12/2018-12-10-gitlab-migrate.md","filePath":"posts/2018/12/2018-12-10-gitlab-migrate.md","lastUpdated":1718173059000}'),p={name:"posts/2018/12/2018-12-10-gitlab-migrate.md"};function n(l,a,h,d,r,c){return e(),i("div",null,a[0]||(a[0]=[t(`<h2 id="同版本迁移" tabindex="-1">同版本迁移 <a class="header-anchor" href="#同版本迁移" aria-label="Permalink to &quot;同版本迁移&quot;">​</a></h2><p>备份原来服务器</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gitlab-rake</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> gitlab:backup:create</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> RAILS_ENV=production</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>/var/opt/gitlab/backups/1544603502_2018_12_12_11.5.1_gitlab_backup.tar</span></span></code></pre></div><p>新服务器上安装<strong>相同版本</strong>Gitlab</p><p>拷贝旧服务器的备份文件到新服务器的backups目录，</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>/var/opt/gitlab/backups/1544603502_2018_12_12_11.5.1_gitlab_backup.tar</span></span></code></pre></div><p>在新服务器上执行恢复：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># backup指定文件名不需要版本号</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gitlab-rake</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> gitlab:backup:restore</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> RAILS_ENV=production</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   BACKUP=1544603502_2018_12_12</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 根据提示操作</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 操作完成新版本的直接生效，老版本的需要重启</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gitlab-ctl</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> restart</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gitlab-rake</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> gitlab:check</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> SANITIZE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span></span></code></pre></div><h2 id="不同版本迁移" tabindex="-1">不同版本迁移 <a class="header-anchor" href="#不同版本迁移" aria-label="Permalink to &quot;不同版本迁移&quot;">​</a></h2><p>可以使用Gitlab的Import功能导入， 如果包含Wiki的话，</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>git check old-url/group/project.wiki.git</span></span>
<span class="line"><span>git remote set-url origin new-url/group/project.wiki.git</span></span>
<span class="line"><span>git push</span></span></code></pre></div>`,12)]))}const g=s(p,[["render",n]]);export{k as __pageData,g as default};
