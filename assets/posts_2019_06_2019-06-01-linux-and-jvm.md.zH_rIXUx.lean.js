import{_ as a,a as i,af as e,o as t}from"./chunks/framework.C87LdZyP.js";const c=JSON.parse('{"title":"Linux常用运维命令","description":"","frontmatter":{"title":"Linux常用运维命令","date":"2019-06-01T00:00:00.000Z","tags":["linux","jvm"]},"headers":[],"relativePath":"posts/2019/06/2019-06-01-linux-and-jvm.md","filePath":"posts/2019/06/2019-06-01-linux-and-jvm.md","lastUpdated":1718173059000}'),n={name:"posts/2019/06/2019-06-01-linux-and-jvm.md"};function h(l,s,p,r,k,d){return t(),i("div",null,s[0]||(s[0]=[e(`<h2 id="查看进程" tabindex="-1">查看进程 <a class="header-anchor" href="#查看进程" aria-label="Permalink to &quot;查看进程&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ps</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> aux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> tomcat</span></span></code></pre></div><h2 id="查看线程状态" tabindex="-1">查看线程状态 <a class="header-anchor" href="#查看线程状态" aria-label="Permalink to &quot;查看线程状态&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -T</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -p</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -Lf</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span></span></code></pre></div><h2 id="查看连接" tabindex="-1">查看连接 <a class="header-anchor" href="#查看连接" aria-label="Permalink to &quot;查看连接&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 连接数</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -ltp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -stp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 连接时间</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -tn</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -stpn</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -o</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 根据第一列排序</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -stpn</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -o</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> grep</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -t1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Display Currently Established, Closed, Orphaned and Waiting TCP sockets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Display All Open Network Ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -tulpn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Display All TCP Sockets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -t</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -a</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -nat</span></span></code></pre></div><h2 id="内存" tabindex="-1">内存 <a class="header-anchor" href="#内存" aria-label="Permalink to &quot;内存&quot;">​</a></h2><h3 id="linux-内存" tabindex="-1">Linux 内存 <a class="header-anchor" href="#linux-内存" aria-label="Permalink to &quot;Linux 内存&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">pmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -x/d/X</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID</span></span></code></pre></div><ul><li>Address: 内存开始地址</li><li>Kbytes: 占用内存的字节数（KB）</li><li>RSS: 保留内存的字节数（KB）</li><li>Dirty: 脏页的字节数（包括共享和私有的）（KB）</li><li>Mode: 内存的权限：read、write、execute、shared、private (写时复制)</li><li>Mapping: 占用内存的文件、或[anon]（分配的内存）、或[stack]（堆栈）</li><li>Offset: 文件偏移</li><li>Device: 设备名 (major:minor)</li></ul><h3 id="jvm堆外内存分析-nmt-native-memory-tracking" tabindex="-1">JVM堆外内存分析 NMT(native memory tracking) <a class="header-anchor" href="#jvm堆外内存分析-nmt-native-memory-tracking" aria-label="Permalink to &quot;JVM堆外内存分析 NMT(native memory tracking)&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># -XX:NativeMemoryTracking=[off | summary | detail]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">-XX:NativeMemoryTracking</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">=detail</span></span></code></pre></div><h3 id="jcmd" tabindex="-1">jcmd <a class="header-anchor" href="#jcmd" aria-label="Permalink to &quot;jcmd&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 列出所有支持的命令    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">jcmd</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> $PID </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">help</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> # jcmd pid VM.native_memory [summary | detail | baseline | summary.diff | detail.diff | shutdown] [scale= KB | MB | GB]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> jcmd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> pid</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> VM.native_memory</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> detail</span></span></code></pre></div><h2 id="两种内存溢出" tabindex="-1">两种内存溢出 <a class="header-anchor" href="#两种内存溢出" aria-label="Permalink to &quot;两种内存溢出&quot;">​</a></h2><h3 id="java-lang-outofmemoryerror-java-heap-space" tabindex="-1">java.lang.OutOfMemoryError: Java heap space <a class="header-anchor" href="#java-lang-outofmemoryerror-java-heap-space" aria-label="Permalink to &quot;java.lang.OutOfMemoryError: Java heap space&quot;">​</a></h3><h3 id="java-lang-outofmemoryerror-native-memory-exhausted" tabindex="-1">java.lang.OutOfMemoryError: native memory exhausted <a class="header-anchor" href="#java-lang-outofmemoryerror-native-memory-exhausted" aria-label="Permalink to &quot;java.lang.OutOfMemoryError: native memory exhausted&quot;">​</a></h3><p>The best answer comes from an article written a while back explaining the memory layout of the JVM: Thanks for the Memory</p><p>A good thing to understand about native outofmemory is that the underlying cause is not easily understood from any of the regular debug methods (heapdumps, system core files). More recent versions of the JVM do produce javacores that contain some insight into the most common of the native memory culprits (DBBs, classloader,too large Xmx value). However one should expect to have to rule out the most common causes first and then seek more invasive native memory tracing in an iterative process of finding the trigger.</p><p>Start with the &quot;Thanks for the Memory&quot; article to understand the JVM memory model. If java.lang.OutOfMemoryError: Java heap space is the problem, then use the MAT tool to investigate a heapdump that was produced by the OutOfMemory (OOM). If java.lang.OutOfMemoryError: native memory exhausted is the problem, first check that there are adequate resources for your application serving environment. Check the <a href="http://www-01.ibm.com/support/docview.wss?uid=swg21469413" target="_blank" rel="noreferrer">ulimits</a>. Then check the NATIVEMEMINFO section of a javacore created from a NOOM and determine the largest native memory consumers. Then determine which components may contribute to this native memory.</p><p>Additional troubleshooting steps: <a href="http://www-01.ibm.com/support/docview.wss?uid=swg21373312" target="_blank" rel="noreferrer">Troubleshooting native memory issues</a></p>`,22)]))}const g=a(n,[["render",h]]);export{c as __pageData,g as default};
