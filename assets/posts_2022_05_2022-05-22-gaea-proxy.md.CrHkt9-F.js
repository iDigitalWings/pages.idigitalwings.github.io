import{_ as s,a as i,o as a,aj as n}from"./chunks/framework.Ba_Ek9Jm.js";const l="/assets/architecture.MP4edvBs.png",t="/assets/deployment.CAIe-t3U.png",D=JSON.parse('{"title":"Gaea Proxy","description":"","frontmatter":{"title":"Gaea Proxy","date":"2022-05-22T00:00:00.000Z","tags":["其它","mysql"],"category":["其它"]},"headers":[],"relativePath":"posts/2022/05/2022-05-22-gaea-proxy.md","filePath":"posts/2022/05/2022-05-22-gaea-proxy.md","lastUpdated":1718173059000}'),h={name:"posts/2022/05/2022-05-22-gaea-proxy.md"},p=n('<h2 id="gaea-介绍" tabindex="-1">Gaea 介绍 <a class="header-anchor" href="#gaea-介绍" aria-label="Permalink to &quot;Gaea 介绍&quot;">​</a></h2><p><a href="https://github.com/XiaoMi/Gaea" target="_blank" rel="noreferrer">Gaea</a> 是小米中国区电商研发部研发的基于mysql协议的数据库中间件， 目前在小米商城大陆和海外得到广泛使用，包括订单、社区、活动等多个业务。 Gaea支持分库分表、sql路由、读写分离等基本特性，更多详细功能可以参照下面的功能列表。 其中分库分表方案兼容了mycat和kingshard两个项目的路由方式。 Gaea在设计、实现阶段参照了mycat、kingshard和vitess，并使用tidb parser作为内置的sql parser。</p><h3 id="功能列表" tabindex="-1">功能列表 <a class="header-anchor" href="#功能列表" aria-label="Permalink to &quot;功能列表&quot;">​</a></h3><p>基础功能</p><ul><li>多集群</li><li>多租户</li><li>SQL透明转发</li><li>慢SQL指纹</li><li>错误SQL指纹</li><li>注解路由</li><li>慢日志</li><li>读写分离，从库负载均衡</li><li>自定义SQL拦截与过滤</li><li>连接池</li><li>配置热加载</li><li>IP/IP段白名单</li><li>全局序列号</li></ul><p>分库、分表功能</p><ul><li>分库: 支持mycat分库方式</li><li>分表: 支持kingshard分表方式</li><li>聚合函数: 支持max、min、sum、count、group by、order by等</li><li>join: 支持分片表和全局表的join、支持多个分片表但是路由规则相同的join</li></ul><h3 id="架构图" tabindex="-1">架构图 <a class="header-anchor" href="#架构图" aria-label="Permalink to &quot;架构图&quot;">​</a></h3><p><img src="'+l+'" alt=""></p><p>Gaea包含四个模块， 分别是gaea-proxy、gaea-cc、gaea-agent、gaea-web：</p><ul><li>gaea-proxy为在线代理，负责承接sql流量，</li><li>gaea-cc是中控模块，负责gaea-proxy的配置管理及一些后台任务，</li><li>gaea-agent部署在mysql所在的机器上，负责实例创建、管理、回收等工作，</li><li>gaea-web是gaea的一个管理界面，使gaea整体使用更加方便。</li></ul><h3 id="基本概念" tabindex="-1">基本概念 <a class="header-anchor" href="#基本概念" aria-label="Permalink to &quot;基本概念&quot;">​</a></h3><ul><li><strong>cluster</strong>： 集群, 按照业务重要程度划分集群, 一个集群内可包含多个gaea-proxy实例, 通过指定gaea-proxy启动时依赖的配置文件中的cluster_name 确定该proxy所属集群。集群内的proxy实例只为该集群内的namespace提供服务, 起到物理隔离的作用。 一套集群可为多个namespace提供服务。</li><li><strong>namespace</strong>： 命名空间，每一个业务系统对应一个namespace，一个namespace对应多个database，业务方可以自由切换。 每个namespace理论上只会属于一个集群。 通过gaea-cc配置管理接口, 指定namespace所属集群。</li><li><strong>slice</strong>：分片，逻辑上的分组，一个分片包含mysql一主多从。</li><li><strong>shard</strong>：分表规则，确定一个表如何分表，包括分表的类型、分布的分片位置。</li><li><strong>proxy</strong>： 指代理本身，承接线上流量。</li><li><strong>gaea_cc</strong>： 代理控制模块，主要负责配置下发、实例监控等。</li><li><strong>gaea_agent</strong>： 部署在mysql实例所在机器，负责实例部署、管理、执行插件等功能。</li></ul><h3 id="集群部署图" tabindex="-1">集群部署图 <a class="header-anchor" href="#集群部署图" aria-label="Permalink to &quot;集群部署图&quot;">​</a></h3><p><img src="'+t+`" alt=""></p><p>如上图所示, 部署一套gaea-cc和etcd可用来管理多套gaea集群, 负责集群内namespace配置的增删改查。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>部署架构图中的 gaea-cc 和 etcd 在生产环境中充当配置下发和配置持久化的角色。 在测试环境中可以用 json 文件静态配置做演示， 以下测试为基于 json 文件做的测试。</p></div><h2 id="sql-兼容性" tabindex="-1">SQL 兼容性 <a class="header-anchor" href="#sql-兼容性" aria-label="Permalink to &quot;SQL 兼容性&quot;">​</a></h2><h3 id="协议兼容性" tabindex="-1">协议兼容性 <a class="header-anchor" href="#协议兼容性" aria-label="Permalink to &quot;协议兼容性&quot;">​</a></h3><p>Gaea支持text协议和binary协议.</p><h3 id="sql兼容性" tabindex="-1">SQL兼容性 <a class="header-anchor" href="#sql兼容性" aria-label="Permalink to &quot;SQL兼容性&quot;">​</a></h3><p>Gaea对分表和非分表的兼容性有所不同. 非分表理论上支持所有DML语句, 部分ADMIN语句.</p><p>对分表情况, Gaea本身的定位是轻量级, 高性能, 因此采用轻量的分表实现方式, 对一条SQL的执行, 只做字段改写和结果聚合, 不做SQL语义上的改写和多条SQL结果集的拼接计算.</p><p>以下支持/不支持操作均指分表情况.</p><h3 id="select" tabindex="-1">SELECT <a class="header-anchor" href="#select" aria-label="Permalink to &quot;SELECT&quot;">​</a></h3><p>明确支持以下操作:</p><ul><li>JOIN操作支持一个父表和多个关联子表, 以及全局表.</li><li>聚合函数支持SUM, MAX, MIN, COUNT, 且必须出现在最外层.</li><li>WHERE语句的条件支持AND, OR, 操作符支持=, &gt;, &gt;=, &lt;, &lt;=, &lt;=&gt;, IN, NOT IN, LIKE, NOT LIKE.</li><li>支持GROUP BY.</li></ul><p>明确不支持以下操作:</p><ul><li>不支持跨分片JOIN. JOIN中非分片键相关的条件, 只改写表名, 不计算路由, 走默认的广播路由.</li><li>JOIN USING不支持指定表名或DB名.</li><li>表别名不允许与表名重复. <ul><li>select animals.id from animals, test1.xm_order_extend as animals;</li><li>这句SQL在MySQL中被认为是正确的, 但是gaea会明确拒绝这种操作.</li></ul></li></ul><h3 id="insert" tabindex="-1">INSERT <a class="header-anchor" href="#insert" aria-label="Permalink to &quot;INSERT&quot;">​</a></h3><p>明确不支持以下操作:</p><ul><li>不明确指定列名的INSERT</li><li>跨分片批量INSERT</li><li>INSERT INTO SELECT</li></ul><h3 id="update" tabindex="-1">UPDATE <a class="header-anchor" href="#update" aria-label="Permalink to &quot;UPDATE&quot;">​</a></h3><p>明确不支持以下操作:</p><ul><li>UPDATE多个表</li></ul><h3 id="事务兼容性" tabindex="-1">事务兼容性 <a class="header-anchor" href="#事务兼容性" aria-label="Permalink to &quot;事务兼容性&quot;">​</a></h3><ul><li>Gaea目前未实现分布式事务, 只支持单分片事务, 使用跨分片事务会报错.</li><li>不支持 <code>SAVEPOINT</code>, <code>RELEASE SAVEPOINT</code>, <code>ROLLBACK TO SAVEPOINT TODO</code></li></ul><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><h3 id="编译安装" tabindex="-1">编译安装 <a class="header-anchor" href="#编译安装" aria-label="Permalink to &quot;编译安装&quot;">​</a></h3><p>gaea基于go开发，基于go modules进行版本管理，并依赖goyacc、gofmt等工具。</p><ul><li>go &gt;= 1.11</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 如果你已配置GOPATH，同时GO111MODULE设置为auto，请克隆Gaea到GOPATH外的目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> git@github.com:XiaoMi/Gaea.git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 如果拉取依赖速度慢，可以配置GOPROXY</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># export GOPROXY=https://athens.azurefd.net</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 编译二进制包</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Gaea</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">make</span></span></code></pre></div><h3 id="执行" tabindex="-1">执行 <a class="header-anchor" href="#执行" aria-label="Permalink to &quot;执行&quot;">​</a></h3><p>编译之后在bin目录会有<code>gaea</code>、<code>gaea-cc</code>两个可执行文件。 <code>etc</code>目录下为配置文件，如果想快速体验gaea功能，可以采用file配置方式， 然后在<code>etc/file/namespace</code>下添加对应租户的json文件， 该目录下目前有两个示例，可以直接修改使用。</p><p><code>./bin/gaea --help</code>显示如下，其中<code>-config</code>是指定配置文件位置， 默认为<code>./etc/gaea.ini</code>，具体配置见配置说明。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">Usage</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ./bin/gaea:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">  -config</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">    gaea</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (default </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;etc/gaea.ini&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span></code></pre></div><h2 id="配置说明" tabindex="-1">配置说明 <a class="header-anchor" href="#配置说明" aria-label="Permalink to &quot;配置说明&quot;">​</a></h2><p>gaea配置由两部分组成，本地配置和 Namespace 配置。</p><ul><li>本地配置为gaea_proxy直接使用的配置内容，一般不需要在运行时改变。</li><li>gaea为多租户模式，每个租户称为一个namespace，namespace 的配置在运行时都可变，一般保存在etcd中。</li></ul><h3 id="本地配置说明" tabindex="-1">本地配置说明 <a class="header-anchor" href="#本地配置说明" aria-label="Permalink to &quot;本地配置说明&quot;">​</a></h3><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">; 配置类型，目前支持file/etcd两种方式，file方式不支持热加载，但是可以快速体验功能</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">; file 模式下读取file_config_path下的namespace配置文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">; etcd 模式下读取coordinator_addr/cluster_name下的namespace配置文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">config_type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=etcd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;file config path, 具体配置放到file_config_path的namespace目录下，该下级目录为固定目录</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">file_config_path</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=./etc/file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;配置中心地址，目前只支持etcd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">coordinator_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=http://127.0.0.1:2379</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;配置中心用户名和密码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=test</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;环境划分、test、online</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">environ</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=test </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;service name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">service_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=gaea_proxy</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;gaea_proxy 当前proxy所属的集群名称</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">cluster_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=gaea_default_cluster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;日志配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">log_path</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=./logs</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">log_level</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=Notice</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">log_filename</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=gaea</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">log_output</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;管理地址</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">admin_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=0.0.0.0:13307</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;basic auth</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">admin_user</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=admin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">admin_password</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;代理服务监听地址</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">proto_type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=tcp4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">proxy_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=0.0.0.0:13306</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">; 默认编码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">proxy_charset</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=utf8</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;慢sql阈值，单位: 毫秒</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">slow_sql_time</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=100</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;空闲会话超时时间,单位: 秒</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">session_timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=3600</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;打点统计配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">stats_enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">stats_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=10 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;encrypt key, 用于对etcd中存储的namespace配置加解密</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">encrypt_key</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=1234abcd5678efg*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;server_version 服务器版本号配置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">server_version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=5.6.20-gaea</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;auth plugin mysql_native_password or caching_sha2_password or &#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;自定义认证插件，支持 5.x 和 8.x 版本认证，认证插件为 caching_sha2_password 时，不支持低版本客户端认证</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">;auth_plugin=mysql_native_password</span></span></code></pre></div><h3 id="namespace配置说明" tabindex="-1">namespace配置说明 <a class="header-anchor" href="#namespace配置说明" aria-label="Permalink to &quot;namespace配置说明&quot;">​</a></h3><p>详细配置参考文档。</p><p>gaea 支持多租户，每个租户单独一个namespace，每个namespace 一个配置文件</p><p>gaea 支持kingshard 和mycat 两种sharding 方式，本次测试使用kingshard 的hash方式分表，</p><p>namespace 配置文件必须位于gaea 编译目录 <code>etc/file/namespace</code> 目录下，以下配置主要做这些事项：</p><ul><li>同时开启kingshard 和mycat 两种分库分表方式（测试只用kingshard 这种）</li><li>配置前端接受请求的用户（gaea）和后端连接Aurora 的用户（root）</li><li>启用读写分离</li><li>数据分片规则如下： <ul><li>使用kingshard 的hash 方式对tbl_ks 做了3个物理集群（slice），分片key 配置的是id 字段</li><li>3个物理分片下都有一个分表（location 1，1，1）</li><li>把tbl_ks2表配置成tbl_ks 的关联表(proxy自动会根据父表的分片规则把子表数据分布到同slice中以方便做join和关联查询）</li><li>把tbl_global 配置成全局表（所有分片都有这个表的全量数据）</li><li>非分片查询的SQL 默认发送到slice 1（default_slice”: “slice-1）</li></ul></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;gaea_namespace_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;online&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;read_only&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;allowed_dbs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">        &quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">        &quot;db_mycat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;default_phy_dbs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">        &quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">        &quot;db_mycat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;db_mycat&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;slow_sql_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;1000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;black_sql&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;allowed_ip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;slices&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;slice-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;user_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Pass1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;master&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-1.cluster-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;slaves&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-1.cluster-ro-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;max_capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;idle_timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;slice-2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;user_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Pass1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;master&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-2.cluster-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;slaves&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-2.cluster-ro-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;max_capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;idle_timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;slice-3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;user_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Pass1234&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;master&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-3.cluster-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;slaves&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;shard-3.cluster-ro-c3luzotrlr7v.ap-southeast-1.rds.amazonaws.com:3306&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;max_capacity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;idle_timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;shard_rules&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;db&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;tbl_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;locations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;slices&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                &quot;slice-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                &quot;slice-2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                &quot;slice-3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">           &quot;db&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">           &quot;table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;tbl_ks2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">           &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;linked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">           &quot;parent_table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;tbl_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">           &quot;key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;id&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;db&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;db_ks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;table&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;tbl_global&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;global&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;locations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;slices&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        &quot;slice-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        &quot;slice-2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        &quot;slice-3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">              ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;global_sequences&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;user_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;gaea&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;gaea_password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;namespace&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;gaea_namespace_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;rw_flag&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">            &quot;rw_split&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;default_slice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;slice-1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;open_general_log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;max_sql_execute_time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8DDB8C;">    &quot;max_sql_result_size&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">100000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="启动-proxy" tabindex="-1">启动 Proxy <a class="header-anchor" href="#启动-proxy" aria-label="Permalink to &quot;启动 Proxy&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">./bin/gaea</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -config</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ./test.ini</span></span></code></pre></div><h3 id="验证连接" tabindex="-1">验证连接 <a class="header-anchor" href="#验证连接" aria-label="Permalink to &quot;验证连接&quot;">​</a></h3><p>使用动态配置文件中指定的用户名和密码连接proxy， 因为上面的动态配置文件开启了kingshard 和mycat 两种分库分表方式， 所以登陆后默认看到两个预先配置好的proxy里的database：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -ugaea</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -pgaea_password</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -P13306</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -h127.0.0.1</span></span></code></pre></div><p>todo</p><ul><li><a href="https://aws.amazon.com/blogs/database/sharding-with-amazon-relational-database-service/" target="_blank" rel="noreferrer">https://aws.amazon.com/blogs/database/sharding-with-amazon-relational-database-service/</a></li><li><a href="https://aws.amazon.com/cn/blogs/china/make-further-progress-shardingsphere-proxy-chapter-of-amazon-auroras-reading-and-writing-ability-expansion/" target="_blank" rel="noreferrer">https://aws.amazon.com/cn/blogs/china/make-further-progress-shardingsphere-proxy-chapter-of-amazon-auroras-reading-and-writing-ability-expansion/</a></li><li><a href="https://aws.amazon.com/cn/blogs/china/make-further-progress-gaea-chapter-on-expanding-auroras-reading-and-writing-ability/" target="_blank" rel="noreferrer">https://aws.amazon.com/cn/blogs/china/make-further-progress-gaea-chapter-on-expanding-auroras-reading-and-writing-ability/</a></li><li><a href="https://github.com/XiaoMi/Gaea" target="_blank" rel="noreferrer">https://github.com/XiaoMi/Gaea</a></li></ul>`,65),e=[p];function k(r,d,o,g,c,C){return a(),i("div",null,e)}const A=s(h,[["render",k]]);export{D as __pageData,A as default};
